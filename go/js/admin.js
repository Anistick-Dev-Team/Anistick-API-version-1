var _____WB$wombat$assign$function_____ = function(name) {return (self._wb_wombat && self._wb_wombat.local_init && self._wb_wombat.local_init(name)) || self[name]; };
if (!self.__WB_pmw) { self.__WB_pmw = function(obj) { this.__WB_source = obj; return this; } }
{
  let window = _____WB$wombat$assign$function_____("window");
  let self = _____WB$wombat$assign$function_____("self");
  let document = _____WB$wombat$assign$function_____("document");
  let location = _____WB$wombat$assign$function_____("location");
  let top = _____WB$wombat$assign$function_____("top");
  let parent = _____WB$wombat$assign$function_____("parent");
  let frames = _____WB$wombat$assign$function_____("frames");
  let opener = _____WB$wombat$assign$function_____("opener");

var URL_DELETE_TOPIC="/ajax/deleteThread";var URL_ADD_BLACKLIST="/ajax/addBlacklist";var URL_ADD_WHITELIST="/ajax/addBlacklist";var URL_GET_USERINFO="/ajax/getuserinfo";var URL_GET_TXNINFO="/ajax/gettxninfo";var URL_CHANGE_USER_STATUS="/ajax/changeUserStatus";var URL_REMOVE_USER="/ajax/removeUser";var URL_CHANGE_USER_EMAIL="/ajax/changeUserEmail";var URL_CHANGE_USER_PASSWD="/ajax/changeUserPasswd";var URL_ADMIN_LOGIN_USER="/ajax/adminLoginUser";var URL_ADMIN_MOVE_TOPIC="/ajax/adminMoveTopic";var URL_ADMIN_ADD_USER_CC_CREDITs="/ajax/adminAddUserCCCredits";var URL_CHECK_USER_VIDEO_QUOTA="/ajax/checkUserVideoQuota";var URL_ADD_USER_VIDEO_QUOTA="/ajax/addUserVideoQuota";var URL_GET_BIZVIDEOINFO="/ajax/getbizvideoinfo";var URL_GET_VIDEOINFO="/ajax/getvideoinfo";var URL_RESET_VIDEOCOUNTER="/ajax/resetvideocounter";var URL_RECONVERT_VIDEO="/ajax/reconvertvideo";var URL_TRACE_USERINFO="/ajax/traceuserinfo";var URL_UPDATE_USER_POINTS="/ajax/updateuserpoints";var URL_DOWNGRADE_GOPLUS="/ajax/downgradePlus";var URL_DOWNGRADE_COMMERCIAL="/ajax/downgradeCommercial";var URL_DOWNGRADE_TEAM="/ajax/downgradeTeam";var URL_GET_FLAGINFO="/ajax/getflaginfo";var URL_ADMIN_CONVERT="/ajax/adminconvert";var URL_VEEDIOS_CONVERT="/ajax/veediosconvert";var URL_VEEDIOS_PUBLISH="/ajax/veediospublish";var URL_GET_PLUS_TXN="/ajax/viewPlusCommercialTxn";var URL_GET_COMMERCIAL_TXN="/ajax/viewPlusCommercialTxn";var URL_GET_TEAM_TXN="/ajax/viewPlusCommercialTxn";var URL_GET_TXN="/ajax/viewTxn";var URL_GET_ACCESS_LOG="/ajax/viewAccessLog";var URL_GET_ERROR_LOG="/ajax/viewErrorLog";var URL_MODERATE_WATERMARK="/ajax/moderatewatermark";var URL_CHECK_CHARGIFY_REFUND="/ajax/checkChargifyRefund";var URL_CONFIRM_CHARGIFY_REFUND="/ajax/confirmChargifyRefund";var URL_UPDATE_EXPIRY_AFTER_REFUND="/ajax/updateExpiryAfterRefund";var URL_SEARCH_COUPON_USAGE="/ajax/searchCouponUsage";var URL_ADMIN_MARK_FAIL="/ajax/adminmarkfailvideo";var URL_TEAM_UPDATE_SEAT="/ajax/teamUpdateSeatByAdmin";var URL_TEAM_LIST_MEMBER="/ajax/teamListMemberByAdmin";var URL_TEAM_MANAGE_MEMBER="/ajax/teamMemberByAdmin";var URL_TOGGLE_AUTO_RENEWAL="/ajax/adminToggleAutoRenew";var URL_GET_CHARGIFY_EMAIL="/ajax/adminGetChargifyEmail";var URL_UPDATE_CHARGIFY_EMAIL="/ajax/adminUpdateChargifyEmail";var URL_TEAM_MAKE_INVOICE_FORM="/ajax/teamOrderInvoiceFormByAdmin";var URL_TEAM_MAKE_INVOICE="/ajax/teamOrderInvoiceByAdmin";var URL_TEAM_PREVIEW_INVOICE="/ajax/teamPreviewOrderInvoiceByAdmin";var URL_TEAM_PAY_INVOICE="/ajax/teamActivateOrderInvoiceByAdmin";var URL_TEAM_CANCEL_INVOICE="/ajax/teamCancelOrderByAdmin";var URL_TEAM_LIST_PENDING_INVOICE="/ajax/listTeamUnpaidOrderByAdmin";var URL_TEAM_LIST_ALL_INVOICE="/ajax/listAllTeamOrderInvoicesByAdmin";var URL_TEAM_LIST_ALL_EXPIRING_INVOICE="/ajax/listAllTeamExpiringInvoiceSubByAdmin";var URL_BLOCK_PURCHASE="/ajax/adminBlockPurchase";var refund_submitted=false;var update_expiry_after_refund_submitted=false;function deleteThread(b,c,a){var d="Are you sure to remove "+a+"?";if(!confirm(d)){return}jQuery.post(URL_DELETE_TOPIC+"/"+b+"/"+c,function(e){parseResponse(e);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Thread has been removed")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function addBlacklist(b){var a=jQuery("#"+b);if(a.find("[name=content]").val()==""){displayFeedback("3Please enter the blacklist");return}jQuery.post(URL_ADD_BLACKLIST,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Blacklist has been added");a.form("reset")}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function addWhitelist(b){var a=jQuery("#"+b);if(a.find("[name=content]").val()==""){displayFeedback("3Please enter the whitelist");return}jQuery.post(URL_ADD_WHITELIST,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Whitelist has been added");a.form("reset")}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function getBlacklist(a){location.href="/go/admin/blacklist/"+a.options[a.selectedIndex].value}function getWhitelist(a){location.href="/go/admin/whitelist/"+a.options[a.selectedIndex].value}function getUserInfo(b){var a=jQuery("#"+b);if(a.find("input[name=login]").val()==""&&a.find("input[name=txn_first_name]").val()==""&&a.find("input[name=txn_last_name]").val()==""&&a.find("input[name=txn_dates_ccnum]").val()==""){displayFeedback("3Please enter search parameter(s)");return}jQuery.post(URL_GET_USERINFO,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"User information is retrieved");jQuery("#userinfobox").html(responseArray.html);jQuery("#userinfobox").trigger("loaded").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function getTxnInfo(b){var a=jQuery("#"+b);if(a.find("[name=content]").val()==""){displayFeedback("3Please enter the value");return}jQuery.post(URL_GET_USERINFO,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Payment information is retrieved");jQuery("#txninfobox").html(responseArray.html);jQuery("#txninfobox").show();a.form("reset")}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function adminSearchCoupon(b){var a=jQuery("#"+b);jQuery.post(URL_SEARCH_COUPON_USAGE,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Coupon usage information is retrieved");jQuery("#txninfobox").html(responseArray.html).show()}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()});return false}function adminUpdateUserEmail(a){if(!confirm("Are you sure to change the email of the user?")){return}var b={email:jQuery("#useremailinput").val()};jQuery.post(URL_CHANGE_USER_EMAIL+"/"+a,b,function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"User's email has been updated");jQuery("#userEmailBox").hide();jQuery("#userEmailCtrl").show();jQuery("#userEmail").html(jQuery("#useremailinput").val());jQuery("#useremailinput").val("")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function markFailVideo(a){if(!confirm("Are you sure to mark fail the video conversion?")){return}var b={};jQuery.post(URL_ADMIN_MARK_FAIL+"/"+a,b,function(c){parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"This movie is now marked fail.")}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function adminUpdateUserPasswd(a){if(!confirm("Are you sure to change the password of the user?")){return}var b={passwd:jQuery("#userpasswdinput").val()};jQuery.post(URL_CHANGE_USER_PASSWD+"/"+a,b,function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"User's password has been updated");jQuery("#userPasswdBox").hide();jQuery("#userPasswdCtrl").show();jQuery("#userpasswdinput").val("")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function adminUpdateUserPoints(c,a){var b=function(){};change_type=false;if(c=="money"){drop_down="#usergobuckstype";text_box="#usergobucksinput";currency="GoBucks";b=function(){jQuery("#userGoBucksCtrl").show();jQuery("#userGoBucksBox").hide();jQuery(text_box).val("")}}else{drop_down="#usergopointstype";text_box="#usergopointsinput";currency="GoPoints";b=function(){jQuery("#userGoPointsCtrl").show();jQuery("#userGoPointsBox").hide();jQuery(text_box).val("")}}update_type=jQuery(drop_down).find(":selected").val();update_value=jQuery(text_box).val();if(!confirm("Are you sure to "+update_type+" "+update_value+" "+currency+" to the user?")){return}var d={user_id:a,type:c,value:update_value,op:update_type};jQuery.post(URL_UPDATE_USER_POINTS,d,function(e){parseResponse(e);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"User's GoBucks/GoPoints has been updated");b()}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function adminChangeUserStatus(a){if(!confirm("Are you sure to change the status of the user?\nunconfirmed -> enabled\nenabled -> disabled")){return}jQuery.post(URL_CHANGE_USER_STATUS+"/"+a,function(b){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Status has been updated");jQuery("#user_status").html(responseArray.json.status)}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function adminRemoveUser(a){if(!confirm("Are you sure to change the remove status of the user?\nNo -> Yes\nYes -> No")){return}jQuery.post(URL_REMOVE_USER+"/"+a,function(b){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){if(responseArray.json.remove_status=="user_is_plus"){if(confirm("User is an active GoPlus user.\n(Please cancel the subscription before removing)\n\nAre you sure to remove the user?")){adminRemoveUser(a+"/true")}}else{displayFeedback(responseArray.code+"Remove status has been updated");jQuery("#user_removed").html(responseArray.json.remove_status)}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function loginUser(a){if(!confirm("Are you sure to login this user?")){return}var b={user_id:a};jQuery.post(URL_ADMIN_LOGIN_USER,b,function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function moveTopic(d){var c=jQuery("#topicname_"+d).html();var b=jQuery("#movetopic_"+d+" option:selected").text();var a=jQuery("#movetopic_"+d+" option:selected").val();if(!confirm("Are you sure to move '"+c+"' to '"+b+"'?")){return}var e={thread_id:d,forum_id:a};jQuery.post(URL_ADMIN_MOVE_TOPIC,e,function(f){parseResponse(f);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){window.location.reload(true)}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function adminAddCCCredits(b,a){if(!confirm("Are you sure to add "+a+" CC Credit(s)?")){return}var c={user_id:b,credits:a};jQuery.post(URL_ADMIN_ADD_USER_CC_CREDITs,c,function(d){parseResponse(d);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"CC Credits has been updated");jQuery("#custom1").html(responseArray.json.credits)}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function getVideoInfo(b){var a=jQuery("#"+b);if(a.find("input[name=login]").val()==""){displayFeedback("3Please enter the user id");return}jQuery.post(URL_GET_VIDEOINFO,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Video information is retrieved");jQuery("#videoinfobox").html(responseArray.html);jQuery("#videoinfobox").show();a.form("reset")}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function getBizVideoInfo(c,b){var a=jQuery("#"+c);if(b==""){b="next"}page_num=parseInt(jQuery("input[name=page]").val(),10);if(b=="prev"){page_num=page_num-1}else{if(b=="next"){page_num=page_num+1}}jQuery("input[name=page]").val(page_num);jQuery.post(URL_GET_BIZVIDEOINFO,a.serialize()+"&page_num="+page_num,function(d){parseResponse(d);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Video information is retrieved");jQuery("#videoinfobox").html(responseArray.html);jQuery("#videoinfobox").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function resetVideoCounter(a){if(!confirm("Are you sure to reset download counter?")){return}jQuery.post(URL_RESET_VIDEOCOUNTER+"/"+a,function(b){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Video counter is reset");jQuery("#download_counter_"+a).html(responseArray.json.counter)}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function reconvertVideo(e,b){var d="Are you sure to re-convert this video ";var a="1";var c=jQuery("#slowspeed_"+e).val();if(c!=""){d+="with slowspeed "+c+"?"}if(!confirm(d)){return}jQuery.post(URL_RECONVERT_VIDEO+"/"+e+"/"+c,function(f){parseResponse(f);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Video reconversion started")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function traceIP(a){location.href="/admin/trace_user?ip="+a}function traceUserInfo(b){var a=jQuery("#"+b);if(a.find("input[name=ip]").val()==""){displayFeedback("3Please enter the IP Address");return}jQuery.post(URL_TRACE_USERINFO,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"User information is retrieved");jQuery("#traceinfobox").html(responseArray.html);jQuery("#traceinfobox").show();a.form("reset")}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function adminDowngradeGoPlus(b,a){if(!confirm("Are you sure to downgrade GoPlus to Basic?")){return}displayFeedback("0Please wait while downgrading in progress...");jQuery.post(URL_DOWNGRADE_GOPLUS+"/"+b+(typeof a==="undefined"?"":"/"+a),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+responseArray.json.error);jQuery("#goplusBox").html("Canceled");if(typeof a!=="undefined"){viewPlusTxn(b)}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function adminDowngradeCommercial(b,a){if(!confirm("Are you sure to downgrade Commercial to Basic?")){return}displayFeedback("0Please wait while downgrading in progress...");jQuery.post(URL_DOWNGRADE_COMMERCIAL+"/"+b+(typeof a==="undefined"?"":"/"+a),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+responseArray.json.error);jQuery("#commercialBox").html("Canceled");jQuery("#autoRenewalStateBox").html("N/A");if(typeof a!=="undefined"){viewCommercialTxn(b)}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function adminDowngradeTeam(b,a){if(!confirm("Are you sure to downgrade Team to Basic?")){return}displayFeedback("0Please wait while downgrading in progress...");jQuery.post(URL_DOWNGRADE_TEAM+"/"+b+(typeof a==="undefined"?"":"/"+a),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+responseArray.json.error);jQuery("#teamBox").html("Canceled");jQuery("#autoRenewalStateBox").html("N/A");if(typeof a!=="undefined"){viewTeamTxn(b)}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function getFlagInfo(b){var a=jQuery("#"+b);jQuery.post(URL_GET_FLAGINFO,a.serialize(),function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Flag report is retrieved");jQuery("#flaginfobox").html(responseArray.html);jQuery("#flaginfobox").show();a.form("reset")}else{displayFeedback(responseArray.code+responseArray.json.error)}}a.form("enable");resetResponse()});a.form("disable")}function adminNoWatermarkConvert(a){if(!confirm("Are you sure you wish to convert this video?")){return}jQuery.post(URL_ADMIN_CONVERT+"/"+a,function(b){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Video conversion job has been dispatched.")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function veediosConvert(a){if(!confirm("Are you sure you wish to convert this video?")){return}jQuery("#veediosconvert").hide();jQuery.post(URL_VEEDIOS_CONVERT+"/"+a,function(b){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Converting the video. Please return to this page to publish to Veedios once you have reviewed the video.")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function veediosPublish(a){if(!confirm("Are you sure you have reviewed the converted video, and would like to get it published to Veedios?")){return}jQuery("#veediospublish").hide();jQuery.post(URL_VEEDIOS_PUBLISH+"/"+a,function(b){parseResponse(b);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Publishing the animation to Veedios. You may close this window at any time.")}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function viewPlusTxn(a){jQuery.post(URL_GET_PLUS_TXN+"/plus/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+"User GoPlus transactions are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function viewCommercialTxn(a,b){jQuery.post(URL_GET_COMMERCIAL_TXN+"/commercial/"+a+(typeof b!="undefined"?("/"+b):""),function(c){parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"User Commercial transactions are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function viewTeamTxn(a,b){jQuery.post(URL_GET_TEAM_TXN+"/team/"+a+(typeof b!="undefined"?("/"+b):""),function(c){parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"User Team transactions are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function viewTxn(a){jQuery.post(URL_GET_TXN+"/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+"User transactions are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function viewAccessLog(b,a){jQuery.post(URL_GET_ACCESS_LOG+"/"+b+(typeof a=="undefined"?"":("/"+a)),function(c){parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"User access logs are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function viewErrorLog(a){jQuery.post(URL_GET_ERROR_LOG+"/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+"User error logs are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function moderateWatermark(a,b){jQuery.ajax({type:"GET",url:URL_MODERATE_WATERMARK+"/"+a+"/"+b,success:function(c){parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"Watermark "+a+" processed.")}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()},error:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}})}function searchComments(){jQuery.ajax({type:"POST",url:"/ajax/adminGetComments",data:jQuery("#searchcommentform").serialize(),success:function(a){parseResponse(a);jQuery("#results").replaceWith(responseArray.html);if(responseArray.code=="0"){displayFeedback(responseArray.code+"Retrieved.")}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()},error:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}})}function validateCouponCreatePlan(){if(jQuery("#couponAmount").val().search(/^\s*$/)>=0&&jQuery("#couponPercent").val().search(/^\s*$/)>=0){displayFeedback("1Please fill in either the coupon percentage or amount");return false}if(jQuery("#couponName").val().search(/^\s*$/)>=0){displayFeedback("1Please fill in an internal name for the coupon");return false}if(jQuery("#couponNamePub").val().search(/^\s*$/)>=0){displayFeedback("1Please fill in a description for display on receipts when coupon is applied");return false}if(jQuery("#couponCodeList").val().search(/^\s*$/)<0){var a=false;jQuery.each(jQuery("#couponCodeList").val().split(/\n/),function(b,c){if(c.length>40){if(!a){displayFeedback('1Coupon code "'+c+'" is longer than 40 characters')}proceed=false;a=true}});if(a){return false}}return true}function lookupCoupon(c,b){var a={type:"POST",url:"/ajax/adminLookupCoupon",data:jQuery("#"+c).serialize()+"&"+b+"=1",success:function(d){if(d.error){displayFeedback("1"+d.error)}else{if(d.url){window.open(d.url)}else{jQuery("#results").replaceWith(d)}}},error:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}};jQuery.ajax(a)}function generateCouponCreatePlan(a){jQuery.ajax({type:"POST",url:"/ajax/generateCouponCreatePlan",data:jQuery("#"+a).serialize(),success:function(b){parseResponse(b);if(responseArray.code=="0"){if(responseArray.json.coupon_id){window.location.reload()}else{jQuery("#results").replaceWith(responseArray.html)}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()},error:function(){displayFeedback("1"+GT.gettext("Error contacting the server"))}})}CouponRestrictionHelper=(function(c){var b=-1;var a=0;return function(e){var f=function(){};var d={getRuleCount:function(){return c(".cr2json",e).length},addAbstractRule:function(i,k){i=i||"";var h=++b;var l={"":function(){return c("<span />").attr("id","cr2json_value_"+h).text("Please select a rule")},pkg_id_current:function(o){return c('<input type="text" />').attr("name","cr2json_value_"+h).val(o||"")},pkg_id_new:function(o){return l.pkg_id_current(o||"")},active_subscriber:function(q){var p="cr2json_value_"+h;var o=p+"_as";var s=p+"_nas";var r=c("<div></div>").append(c('<label><input id="as" type="radio" value="1" />Must be active subscriber</label>').attr("for",o),c('<label><input id="nas" type="radio" value="0" />Must NOT be active subscriber</label>').attr("for",s));c("#as",r).attr("name",p).attr("id",o);c("#nas",r).attr("name",p).attr("id",s);q=(typeof(q)=="undefined"||q)?1:0;c("input",r).each(function(){c(this).attr("checked",q==c(this).val())});return r.children()},ever_be_subscriber:function(q){var p="cr2json_value_"+h;var s=p+"_es";var o=p+"_nes";var r=c("<div></div>").append(c('<label><input id="es" type="radio" value="1" />Must be subscriber before</label>').attr("for",s),c('<label><input id="nes" type="radio" value="0" />Must NOT be subscriber before</label>').attr("for",o));c("#es",r).attr("name",p).attr("id",s);c("#nes",r).attr("name",p).attr("id",o);q=(typeof(q)=="undefined"||q)?1:0;c("input",r).each(function(){c(this).attr("checked",q==c(this).val())});return r.children()},require_credit_card:function(o){return c("<span />").attr("id","cr2json_value_"+h).text("Required").append(c('<input type="hidden" value="1" />').attr("name","cr2json_value_"+h))}};var m=c("<div />").addClass("cr2json").attr("id","cr2json_"+h).data("cr-index",h);var j=c('<span class="optionarea"/>');var g=c('<span class="btn btn-mini btn-danger">X</span>').click(function(){var o=jQuery(this).parents(".cr2json").data("cr-index");m.remove();m=null;d.checkRuleCountUpdate()});var n=c("<select />").attr("name","cr2json_type_"+h).append(c.map([{label:"",value:""},{label:"Current Package ID",value:"pkg_id_current"},{label:"New Package ID",value:"pkg_id_new"},{label:"Active Subscriber",value:"active_subscriber"},{label:"Ever been Subscriber",value:"ever_be_subscriber"},{label:"Require Credit Card",value:"require_credit_card"}],function(o){return c("<option />").attr("value",o.value).text(o.label)})).change(function(){var o=jQuery(this).val();j.empty().append((l[o])())});n.val(i);return m.append(g,n,j.append((l[i])(k)))},checkRuleCountUpdate:function(){var g=d.getRuleCount();if(d.getRuleCount()!=a){a=g;f(a)}}};return{addAbstractRule:function(){var g=d.addAbstractRule();e.append(g);d.checkRuleCountUpdate()},addCurrentPackageRestriction:function(g){var h=d.addAbstractRule("pkg_id_current",g);e.append(h);d.checkRuleCountUpdate()},addNewPackageRestriction:function(g){var h=d.addAbstractRule("pkg_id_new",g);e.append(h);d.checkRuleCountUpdate()},addActiveSubscriberRestriction:function(g){var h=d.addAbstractRule("active_subscriber",g);e.append(h);d.checkRuleCountUpdate()},addEverSubscribedRestriction:function(g){var h=d.addAbstractRule("ever_be_subscriber",g);e.append(h);d.checkRuleCountUpdate()},addRequireCreditCardRestriction:function(g){var h=d.addAbstractRule("require_credit_card");e.append(h);d.checkRuleCountUpdate()},reset:function(){c(".cr2json",e).remove();d.checkRuleCountUpdate()},onRuleCountUpdate:function(g){if(typeof(g)=="function"){f=g}}}}})(jQuery);function couponHelperAddAction(){if(jQuery("#coupon_action_helper")){f_action_index=(typeof(f_action_index)=="undefined")?0:f_action_index+1;var b=jQuery("<div />").addClass("fa2json").attr("id","fa2json_"+f_action_index).attr("data-fa-index",f_action_index);var a=jQuery("<span />").addClass("btn btn-mini btn-danger").text("X").click(function(){var d=jQuery(this).parents(".fa2json").attr("data-fa-index");jQuery("#fa2json_"+d).remove()});var c=jQuery("<select />").attr("name","fa2json_type_"+f_action_index).change(function(){var e=jQuery(this).val(),d=jQuery(this).parents(".fa2json").attr("data-fa-index");switch(e){case"auto_renewal":jQuery("#fa2json_value_"+d).html("Disabled").append(jQuery("<input />").attr("name","fa2json_value_"+d).attr("type","hidden").val(0));break;default:jQuery("#fa2json_value_"+d).text("Please select an action")}}).append(jQuery("<option />").attr("value","").text(""),jQuery("<option />").attr("value","auto_renewal").text("Disable auto-renewal"));b.append(a,c,jQuery("<span />").attr("id","fa2json_value_"+f_action_index).text("Please select an action"));jQuery("#coupon_action_helper").append(b)}}function checkChargifyRefund(b,a){jQuery.post(URL_CHECK_CHARGIFY_REFUND+"/"+b+"/"+a,function(c){parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"The Chargify Transaction details are retrieved, please review the information and click Confirm to refund.");jQuery("#refundmain"+b).html(responseArray.html);jQuery("#refundcontrol"+b).hide();jQuery("#refundmain"+b).show();jQuery("#refundinput"+b).focus()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function hideRefundUI(a){jQuery("#refundmain"+a).hide();jQuery("#refundcontrol"+a).show()}function confirmChargifyRefund(e,a,c,d){var b="Are you sure to Refund $$$?";if(c){b="Are you sure to Mark Txn as Chargeback?"}if(!confirm(b)){return}if(refund_submitted){displayFeedback("1Refund in progress, please wait or try again later.");return}refund_submitted=true;jQuery.post(URL_CONFIRM_CHARGIFY_REFUND,jQuery("#refundform"+e).serialize(),function(f){parseResponse(f);if(responseArray.code=="0"){displayFeedback(responseArray.code+"The Chargify Transcation has been refunded successfully");d(a)}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse();refund_submitted=false})}function checkChange(){selection=jQuery("#selecttype option:selected").val();selection_text=jQuery("#selecttype option:selected").text();if(selection=="transaction_date"){jQuery("#default_input,#ccnum_input,#txn_names_input,#txn_dates_optional").hide();jQuery("#txn_dates_input").show()}else{if(selection=="transaction_first_last"){jQuery("#default_input,#ccnum_input").hide();jQuery("#txn_dates_input,#txn_names_input,#txn_dates_optional").show()}else{if(selection=="transaction_ccnum"){jQuery("#default_input,#txn_names_input").hide();jQuery("#txn_dates_input,#ccnum_input,#txn_dates_optional").show()}else{if(selection_text.indexOf("---")>=0){selection_text=jQuery("#selecttype option:selected").next().text()}selection_text=selection_text.replace(/^\s+/g,"");jQuery("#field_name").html(selection_text);jQuery("#txn_dates_input,#ccnum_input,#txn_names_input,#txn_dates_optional").hide();jQuery("#default_input").show()}}}}function getUserTransactions(a){var b={type:"transaction_user_id",login:a};jQuery.post(URL_GET_USERINFO,b,function(c){parseResponse(c);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"User transactions are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function movieCommercialLicense(b,c){var d="Remove Commercial License from this video?";if(c=="add"){d="Add Commercial License to this video?"}if(!confirm(d)){return}var a="/ajax/admin_videolicense/"+b+"/"+c;jQuery.post(a,function(e){if(e.error){displayFeedback("1"+e.error.message);return}displayFeedback("0"+e.success.message);jQuery("#movie-license-remove").toggle(c=="add");jQuery("#movie-license-add").toggle(c=="remove")},"json")}function toggleTeamUpdateSeatUI(a){jQuery("#"+a).find(".teamUpdateSeatBox-link").toggle();jQuery("#"+a).find(".teamUpdateSeatBox-form").toggle()}function adminTeamUpdateSeat(a){var c=jQuery("#"+a).find('input[name="team_seat_num"]').val(),b=jQuery("#"+a).find('input[name="team_seat_num_used"]').val();if(b>c){displayFeedback("1User have "+b+" used seats, please pause some members first.");return false}if(!confirm('Confirm to update to "'+c+'" seats for this user?')){return false}jQuery.post(URL_TEAM_UPDATE_SEAT,jQuery("#"+a).serialize(),function(d){parseResponse(d);if(responseArray.code=="0"){displayFeedback(responseArray.code+"Seats updated successfully");getUserInfo("getuserinfoForm")}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function listTeamMembers(a){jQuery.post(URL_TEAM_LIST_MEMBER+"/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+"Team members are retrieved");jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function adminToggleAutoRenew(b,c,a){if(!confirm("Are you sure to update auto-renewal status?")){return}displayFeedback("0Please wait while updating in progress...");jQuery.post(URL_TOGGLE_AUTO_RENEWAL+"/"+b+"/"+c+(typeof a==="undefined"?"":"/"+a),function(d){parseResponse(d);if(typeof responseArray.json.url!="undefined"){window.location=responseArray.json.url}else{if(responseArray.code=="0"){displayFeedback(responseArray.code+"Updated");if(responseArray.json.renew=="1"){jQuery("#autoRenewalStateBox").html("Yes")}else{jQuery("#autoRenewalStateBox").html("No")}if(typeof a!=="undefined"){switch(c){case"plus":viewPlusTxn(b);break;case"commercial":viewCommercialTxn(b);break;case"team":viewTeamTxn(b);break}}}else{displayFeedback(responseArray.code+responseArray.json.error)}}resetResponse()})}function updateExpiryAfterRefund(c,a,b){if(!confirm("Are you sure to update the expiry date?")){return}if(update_expiry_after_refund_submitted){displayFeedback("1Update in progress, please wait or try again later.");return}update_expiry_after_refund_submitted=true;jQuery.post(URL_UPDATE_EXPIRY_AFTER_REFUND,jQuery("#expireafterrefundform"+c).serialize(),function(d){parseResponse(d);if(responseArray.code=="0"){displayFeedback(responseArray.code+"The subscription has been updated successfully");b(a)}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse();update_expiry_after_refund_submitted=false})}function teamMemberByAdmin(d,c,b,a){if(!confirm("Are you sure to update the team member?")){return}jQuery.post(URL_TEAM_MANAGE_MEMBER+"/"+d,c,function(e){parseResponse(e);if(responseArray.code=="0"){displayFeedback(responseArray.code+"The team member has been updated successfully");b(a)}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function getUserChargifyEmail(a,b){jQuery(b).parents("tr").find(".chargify-email").text("Loading ...");jQuery.get(URL_GET_CHARGIFY_EMAIL+"/"+a,function(c){parseResponse(c);if(responseArray.code=="0"){jQuery(b).parents("tr").find(".chargify-email").text(responseArray.json.email);jQuery(b).parents("tr").find("form.chargify-email-form input[name=user_id]").val(a).end().find("form.chargify-email-form input[name=email]").val(responseArray.json.email).end().show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function updateUserChargifyEmail(b){var a=jQuery(b);a.parents("tr").find(".chargify-email").text("Loading ...");jQuery.post(URL_UPDATE_CHARGIFY_EMAIL,a.serialize(),function(c){parseResponse(c);if(responseArray.code=="0"){a.parents("tr").find(".chargify-email").text(responseArray.json.email);displayFeedback("0The email has been updated successfully")}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function loadTeamInvoiceForm(a){jQuery.post(URL_TEAM_MAKE_INVOICE_FORM+"/"+a,function(b){parseResponse(b);if(responseArray.code=="0"){jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show();var c=jQuery("#query_data").offset();window.scrollTo(0,c.top)}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function createTeamInvoice(b){var a=jQuery(b);if(!confirm("Are you sure to create new GoTeam invoice order? ")){return}a.find('[type="submit"]').val("Loading ...");jQuery.post(URL_TEAM_MAKE_INVOICE,a.serialize(),function(c){a.find('[type="submit"]').val("Create Invoice");parseResponse(c);if(responseArray.code=="0"){displayFeedback(responseArray.code+"Invoice created: "+responseArray.json.invoice_num);jQuery("#pending_team_order_count").text(parseInt(jQuery("#pending_team_order_count").text(),10)+1);if(typeof responseArray.json.goteam_id!="undefined"){viewTeamPendingOrders(responseArray.json.goteam_id)}else{jQuery("#query_data").hide().text("")}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function previewTeamInvoice(b){var a=jQuery(b);a.find(".preview_amount").html("Loading ...");jQuery.post(URL_TEAM_PREVIEW_INVOICE,a.serialize(),function(c){parseResponse(c);if(responseArray.code=="0"){responseJson=jQuery.parseJSON(c.substring(1));a.find(".preview_amount").html("<div>Total amount: <b>$ "+(responseJson.order_amount/100).toFixed(2)+"</b></div>");if((typeof responseJson.order_discount!="undefined")&&responseJson.order_discount){jQuery.each(responseJson.order_discount,function(d,e){a.find(".preview_amount").prepend("<div>"+(e.type)+": <b>$ "+(e.amount_in_cents/100).toFixed(2)+"</b></div>")});a.find(".preview_amount").prepend("<div>Base amount: <b>$ "+(responseJson.base_order_amount/100).toFixed(2)+"</b></div>")}a.find('[type="submit"]').prop("disabled",false)}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function recordTeamInvoicePayment(a){if(typeof a=="undefined"){displayFeedback("1Missing order ID");return false}if(!confirm("Are you sure to mark this invoice as paid? A receipt will be sent to user automatically.")){return}jQuery("#team-invoice-"+a).addClass("loading");jQuery.post(URL_TEAM_PAY_INVOICE+"/1",{invoice_num:a},function(b){jQuery("#team-invoice-"+a).removeClass("loading");parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+responseArray.json.msg);jQuery("#pending_team_order_count").text(parseInt(jQuery("#pending_team_order_count").text(),10)-1);if(typeof responseArray.json.goteam_id!="undefined"){viewTeamPendingOrders(responseArray.json.goteam_id)}else{jQuery("#query_data").hide().text("")}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function activateTeamInvoiceWithoutPayment(a){if(typeof a=="undefined"){displayFeedback("1Missing order ID");return false}jQuery("#team-invoice-"+a).addClass("loading");jQuery.post(URL_TEAM_PAY_INVOICE+"/0",{invoice_num:a},function(b){jQuery("#team-invoice-"+a).removeClass("loading");parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+responseArray.json.msg);if(typeof responseArray.json.goteam_id!="undefined"){viewTeamPendingOrders(responseArray.json.goteam_id)}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function viewTeamPendingOrders(b,a){jQuery.post(URL_TEAM_LIST_PENDING_INVOICE,{team_id:b,user_id:a},function(c){parseResponse(c);if(responseArray.code=="0"){jQuery("#query_data").html(responseArray.html);jQuery("#query_data").show()}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function cancelTeamInvoiceWithoutPayment(a){if(typeof a=="undefined"){displayFeedback("1Missing order ID");return false}jQuery.post(URL_TEAM_CANCEL_INVOICE,{invoice_num:a},function(b){parseResponse(b);if(responseArray.code=="0"){displayFeedback(responseArray.code+responseArray.json.msg);if(typeof responseArray.json.goteam_id!="undefined"){viewTeamPendingOrders(responseArray.json.goteam_id)}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})}function listAllTeamOrderInvoices(a){if(typeof a=="undefined"){a="unpaid"}jQuery.post(URL_TEAM_LIST_ALL_INVOICE+"/"+a,function(b){if(!b.suc){displayFeedback("1"+b.msg);return}displayFeedback("0"+b.msg);jQuery("#pending_invoice_container").text("");if((typeof b.order_list!="undefined")&&(b.order_list.length>0)){jQuery.each(b.order_list,function(c,f){var d=null;if(f.data){d=jQuery.parseJSON(f.data)}var e=jQuery('<div class="pending_order" />');e.html(" <div><span>Order ID</span><span>"+f.goteam_id+"-"+f.order_num+"</span></div> <div><span>Amount</span><span>$ "+((typeof f.order_amount=="string")?parseFloat(f.order_amount):f.order_amount).toFixed(2)+"</span></div> <div><span>Type</span><span>"+f.order_type+"</span></div> <div><span>Status</span><span>"+((typeof d.activate_before_payment=="undefined"||(!d.activate_before_payment))?"Pending":"Fulfilled")+"</span></div> <div><span>Created at</span><span>"+f.create_dt.substr(0,10)+'</span></div> <div><span><a href="/admin/users/'+f.user_id+'">Lookup User</a></span></div> ');jQuery("#pending_invoice_container").prepend(e)})}},"json")}function listAllTeamExpiringInvoiceSub(){jQuery.post(URL_TEAM_LIST_ALL_EXPIRING_INVOICE,function(a){if(!a.suc){displayFeedback("1"+a.msg);return}displayFeedback("0"+a.msg);jQuery("#expiring_invoice_sub_container").text("");if((typeof a.sub_list!="undefined")&&(a.sub_list.length>0)){jQuery.each(a.sub_list,function(b,e){var c=e.expiry_dt.substr(0,10);var d=jQuery('<div class="expiring_sub" />');d.html(' <div><span>Expiry Date</span><span class="exp_'+(a.server_time>c?"expired":"")+'">'+c+"</span></div> <div><span>Contact</span><span>"+escapeHtml(e.contact_person)+" &lt;"+escapeHtml(e.contact_email)+'&gt;</span></div> <div><span><a href="/admin/users/'+(e.admin_user_id?e.admin_user_id:e.user_id)+'">Lookup User</a></span></div> ');jQuery("#expiring_invoice_sub_container").prepend(d)})}},"json")}function checkVideoQuota(a){jQuery.post(URL_CHECK_USER_VIDEO_QUOTA+"/"+a,function(b){if(b){displayFeedback("0Video Conversion quota received");jQuery("#daily_quota").text(b.daily_quota);jQuery("#monthly_quota").text(b.monthtly_quota);jQuery("#daily_converted").text(b.daily_conversion);jQuery("#monthly_converted").text(b.monthly_conversion);jQuery("#quotas").show();jQuery("#conversions").show()}else{displayFeedback("1Get video conversion quota failed")}},"json")}function addVideoQuota(a){jQuery.post(URL_ADD_USER_VIDEO_QUOTA+"/"+a,function(b){if(b){displayFeedback("0Video Conversion quota received");jQuery("#daily_quota").text(b.daily_quota);jQuery("#monthly_quota").text(b.monthtly_quota);jQuery("#daily_converted").text(b.daily_conversion);jQuery("#monthly_converted").text(b.monthly_conversion);jQuery("#quotas").show();jQuery("#conversions").show()}else{displayFeedback("1Get video conversion quota failed")}},"json")}function adminToggleBlockPurchase(a,b){jQuery.post(URL_BLOCK_PURCHASE+"/"+a+"/"+b,function(c){parseResponse(c);if(responseArray.code=="0"){if(responseArray.json.block=="1"){displayFeedback(responseArray.code+"Blocked user from purchasing subscription");jQuery("#userBlockPurchase").addClass("bp-on").removeClass("bp-off");jQuery(".bp-notice").show()}else{displayFeedback(responseArray.code+"Unblocked user from purchasing subscription");jQuery("#userBlockPurchase").addClass("bp-off").removeClass("bp-on");jQuery(".bp-notice").hide()}}else{displayFeedback(responseArray.code+responseArray.json.error)}resetResponse()})};
